<!DOCTYPE html>
<html lang="en">
<head>
	<title>Hello</title>
	<link rel="stylesheet" type="text/css" href="bower_components/angular/angular-csp.css">
	<link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
</head>
<body ng-app="TestApp" ng-controller="TestController">
	<nav class="navbar navbar-default">
  		<div class="container-fluid">
    		<div class="navbar-header">
      		<a class="navbar-brand" href="#">
        		<img alt="Brand" src="...">
      		</a>
        </div>
      </div>
  </nav>
  <div class="alert alert-info marquee" role="alert">
    <marquee ng-show="currentBet.active">Next Match: <strong>{{players.player1}}</strong> vs <strong>{{players.player2}}</strong></marquee>
    <marquee ng-hide="currentBet.active">Betting is over! <strong>Let's get it on!</strong></marquee>
  </div> 
	<div class="container-fluid">
    <div class="col-md-8">
      <div>
        <iframe src="http://player.twitch.tv/?channel=dada5714" id="screen" width="640" height="300" allowfullscreen></iframe>
      </div>
      <div class="row">
        <div class="col-md-12">
        <div class="alert alert-danger marquee" role="alert">
          <p class="text-center time"><b>{{currentBet.timer.minute}}:<span ng-show="currentBet.timer.second < 10">0</span>{{currentBet.timer.second}}</b></p>
        </div>
        </div>
        <div class="col-md-6">
          <table class="table table-striped">
            <tr>
              <th class="">{{players.player1}} 
                <button type="button" class="btn btn-default btn-sm text-right" ng-click="showBet1 = true">Bet</button>
                <form class="form-inline" ng-show="showBet1" ng-submit="closeBet(1)">
  <div class="form-group">
    <label class="sr-only" for="exampleInputAmount">Amount (in dollars)</label>
    <div class="input-group">
      <div class="input-group-addon">$</div>
      <input type="number" class="form-control" id="exampleInputAmount" placeholder="Amount" ng-model="player1Bet" required>
    </div>
  </div>
</form>
              </th>
            </tr>
            <tr ng-repeat="better in betters.player1">
              <td>${{better.bet}} <small>{{better.name}}<small></td>
            </tr>
          </table>
        </div>
        <div class="col-md-6">
          <table class="table table-striped">
            <tr>
              <th class="align-center">{{players.player2}}
                <button type="button" class="btn btn-default btn-sm text-right" ng-click="showBet2 = true">Bet</button>
                <form class="form-inline" ng-show="showBet2" ng-submit="closeBet(2)">
  <div class="form-group">
    <label class="sr-only" for="exampleInputAmount">Amount (in dollars)</label>
    <div class="input-group">
      <div class="input-group-addon">$</div>
      <input type="number" class="form-control" id="exampleInputAmount" placeholder="Amount"  ng-model="player2Bet" required>
    </div>
  </div>
</form>
              </th>
            </tr>
            <tr ng-repeat="better in betters.player2">
              <td>${{better.bet}} <small>{{better.name}}<small></td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <iframe frameborder="0" scrolling="no" src="http://twitch.tv/dada5714/chat?popout=" height="700" width="325">
    </div>
    </iframe>
	</div>
</body>
<script type="text/javascript" src="bower_components/angular/angular.min.js"></script>
<script type="text/javascript" src="bower_components/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript">
	var app = angular.module('TestApp', [])
	app.controller('TestController', ['$scope', '$interval', function($scope, $interval){
		$scope.name = "Ronald"
    $scope.currentBet = {
      "active":true,
      "timer":{
        "minute":0,
        "second":03
      }
    }
    $scope.startBetTimer = function(){
      stop = $interval(function(){
        var clock = $scope.currentBet.timer
        if(clock.minute > 0 || clock.second > 0){
          if(clock.second == 0){
            clock.second = 60;
            clock.minute -= 1;
          }
        clock.second -= 1;
        }else{
          $scope.stopBetTimer();
        }
      }, 1000)
    }

    $scope.stopBetTimer = function(){
      if(angular.isDefined(stop)){
        $interval.cancel(stop);
        stop = undefined;
        $scope.currentBet.active = false;
      }
    }

    $scope.closeBet = function(player){
      if(player == 1){
        var bet = {
          "name":"Anonymous", 
          "bet":$scope.player1Bet
        }
        $scope.betters.player1.push(bet)
        $scope.showBet1 = false;
      }else{
        var bet = {
          "name":"Anonymous", 
          "bet":$scope.player2Bet
        }
        $scope.betters.player2.push(bet)
        $scope.showBet2 = false;
      }
      $scope.player1Bet = undefined;
      $scope.player2Bet = undefined;
    }
    $scope.betters = {
      "player1": [
        {
          "name":"dada5714",
          "bet":"30"
        },
        {
          "name":"makeitreyn",
          "bet":"10"}
      ],
      "player2": [
        {
          "name":"ionicbearcannon",
          "bet":"5"
        },
        {
          "name":"loldbz",
          "bet":"10"
        }
      ]
    }
    $scope.players = {"player1":"Captain Falcon","player2":"Corrin"}
    $scope.startBetTimer();
	}])
</script>
<style type="text/css">
  .navbar {
    border-radius: 0;
  }
  .marquee {
    margin-top: -20px;
    border-radius: 0;
  }
  .time {
    font-size: 40px;
  }
</style>
</html>